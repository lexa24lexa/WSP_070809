<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Login</title>
</head>
<body>
<nav>
  <a href="/">Home</a>

  <!-- admin only -->
  <a href="/products/new" th:if="${#authorization.expression('hasRole(''ADMIN'')')}">Add Product</a>
  <a href="/categories/new" th:if="${#authorization.expression('hasRole(''ADMIN'')')}">Add Category</a>

  <a href="/about">About Author</a>

  <!-- guest -->
  <a href="/login" th:if="${#authentication == null or #authentication.principal == 'anonymousUser'}">Login</a>

  <!-- user -->
  <span th:if="${#authentication != null and #authentication.principal != 'anonymousUser'}">
    <span th:text="${#authentication.principal.username}"></span>
    <a href="/logout">Logout</a>
  </span>

  <!-- cart for user -->
  <span th:if="${#authorization.expression('hasRole(''USER'')')}" style="float:right; margin-left: 20px;">
    <a href="/cart">Cart (<span id="cartCount">0</span> items) - $<span id="cartTotal">0.00</span></a>
  </span>
</nav>
<h2>Login</h2>
<form th:action="@{/login}" method="post">
  <div>
    <label>Username:</label>
    <input type="text" name="username" required>
  </div>
  <div>
    <label>Password:</label>
    <input type="password" name="password" required>
  </div>
  <button type="submit">Login</button>
</form>
<div th:if="${param.error}" style="color:red">Invalid username or password</div>
<div th:if="${param.logout}" style="color:green">Logged out successfully</div>
</body>
</html>
